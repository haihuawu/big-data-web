<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Data Ninja!</title>

    <!-- Bootstrap -->
    <link href="vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="vendors/nprogress/nprogress.css" rel="stylesheet">
    <!-- iCheck -->
    <link href="vendors/iCheck/skins/flat/green.css" rel="stylesheet">

    <!-- Custom Theme Style -->
    <link href="css/custom.min.css" rel="stylesheet">
    <link href="css/jquery.spin.css" rel="stylesheet">

</head>

<body class="nav-md">
<!-- side bar -->
<div class="col-md-3">
    <div class="left_col scroll-view">
        <div class="navbar nav_title" style="border: 0;">
            <a href="index.html" class="site_title"><i class="fa fa-paw"></i> <span>Data Ninja!</span></a>
        </div>

        <div class="clearfix"></div>

        <br/>

        <!-- sidebar menu -->
        <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
            <div class="menu_section">
                <h3>Choose Analysis Feature</h3>
                <ul class="nav side-menu">
                    <li>
                        <a href="indexSingleProfile.html">Simple Profile</a>
                    </li>
                    <li>
                        <a href="indexColumnValues.html">Column Values</a>
                    </li>
                    <li>
                        <a href="indexCommonValues.html">Common Values</a>
                    </li>
                    <li>
                        <a href="indexColumnCorrelations.html">Column Correlations</a>
                    </li>
                    <li>
                        <a href="indexSimilarity.html">Column Similarity</a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- /sidebar menu -->
    </div>
</div>
<!-- end of side bar -->
<!-- page content -->
<div class="col-md-9" role="main">
    <div class="row">
        <div class="col-md-12">
            <div class="x_panel full-screen">
                <div class="x_title">
                    <h2>Data Ninja Table Querier</h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                               aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>

                <div class="x_content">

                    <!-- start project-detail sidebar -->
                    <div class="col-md-3 col-sm-3 col-xs-12">

                        <section class="panel">
                            <div class="x_title">
                                <h2>Column Values Query</h2>
                                <div class="clearfix"></div>
                            </div>
                            <div class="panel-body">
                                <div class="x_title">
                                    <h4>Table</h4>
                                    <div class="clearfix"></div>
                                </div>
                                <form class="form-horizontal form-label-left">
                                    <div class="form-group">
                                        <div class="col-md-12 col-sm-12 col-xs-12">
                                            <input type="text" class="form-control" value="movies_metadata" placeholder="Table" id="table">
                                        </div>
                                    </div>
                                </form>
                                <div class="x_title">
                                    <h4>Has Value</h4>
                                    <div class="clearfix"></div>
                                </div>
                                <form class="form-horizontal form-label-left">
                                    <div class="form-group">
                                        <div class="col-xs-10">
                                            <input type="text" class="form-control" placeholder="has value" id="hasVal1">
                                        </div>
                                    </div>
                                    <div class="form-group" id="has-val-append-before">
                                        <div class="col-xs-12">
                                            <button type="button" class="btn btn-primary" id="add-has-val">Add Value</button>
                                        </div>
                                    </div>
                                </form>
                                <div class="x_title">
                                    <h4>Not Has Value</h4>
                                    <div class="clearfix"></div>
                                </div>
                                <form class="form-horizontal form-label-left">
                                    <div class="form-group">
                                        <div class="col-xs-10">
                                            <input type="text" class="form-control" placeholder="not has value" id="notHasVal1">
                                        </div>
                                    </div>
                                    <div class="form-group" id="not-has-val-append-before">
                                        <div class="col-xs-12">
                                            <button type="button" class="btn btn-primary" id="add-not-has-val">Add Value</button>
                                        </div>
                                    </div>
                                </form>
                                <form class="form-horizontal form-label-left">
                                    <div class="form-group">
                                        <div class="col-md-9 col-sm-9 col-xs-12">
                                            <button id="submit" class="btn btn-success">Submit</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="spin" data-spin/>


                        </section>

                    </div>
                    <!-- end project-detail sidebar -->

                    <!-- right page -->
                    <div class="col-md-9 col-sm-9 col-xs-12">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="x_panel">
                                <div class="x_content">
                                    <table id="datatable-buttons" class="table table-striped table-bordered">
                                        <thead>
                                        <tr>
                                            <th>val</th>
                                            <th>count</th>
                                        </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- end of right page -->
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /page content -->
<!-- jQuery -->
<script src="vendors/jquery/dist/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="vendors/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- FastClick -->
<script src="vendors/fastclick/lib/fastclick.js"></script>
<!-- NProgress -->
<script src="vendors/nprogress/nprogress.js"></script>
<!-- ECharts -->
<script src="vendors/echarts/dist/echarts.min.js"></script>
<!-- iCheck -->
<script src="vendors/iCheck/icheck.min.js"></script>
<!-- Datatables -->
<script src="vendors/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
<script src="vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
<script src="vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
<script src="vendors/datatables.net-buttons/js/buttons.flash.min.js"></script>
<script src="vendors/datatables.net-buttons/js/buttons.html5.min.js"></script>
<script src="vendors/datatables.net-buttons/js/buttons.print.min.js"></script>
<script src="vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>
<script src="vendors/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
<script src="vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
<script src="vendors/datatables.net-scroller/js/dataTables.scroller.min.js"></script>
<script src="vendors/jszip/dist/jszip.min.js"></script>
<script src="vendors/pdfmake/build/pdfmake.min.js"></script>
<script src="vendors/pdfmake/build/vfs_fonts.js"></script>
<script src="js/jquery.spin.js"></script>

<!-- Custom Theme Scripts -->
<!-- <script src="../build/js/single-profile.js"></script> -->

<script type="text/javascript">
    $(document).on('ready', () => {
        let spinner = $('.spin');
        spinner.spin('hide');
        let requestUrl = "http://167.99.13.127:8001/column-value";
        let hasValBeforeAppend = $("#has-val-append-before");
        let notHasValBeforeAppend = $("#not-has-val-append-before");
        let addHasValButton = $("#add-has-val");
        let addNotHasValButton = $("#add-not-has-val");
        let submitButton = $("#submit");
        let hasValFieldCount = 1;
        let notHasValFieldCount = 1;

        $(addHasValButton).click( (e) => {
            hasValFieldCount++; //text box added increment
            //add input box
            $(hasValBeforeAppend).before('<div class="form-group">\n' +
                '<div class="col-xs-10">\n' +
                '<input type="text" class="form-control" placeholder="has value" id="hasVal' + hasValFieldCount + '">\n' +
                '</div><div class="col-xs-2"><a href="#" class="has-val-remove">×</a></div>' +
                '</div>');
        });

        $(addNotHasValButton).click( (e) => {
            notHasValFieldCount++; //text box added increment
            //add input box
            $(notHasValBeforeAppend).before('<div class="form-group">\n' +
                '<div class="col-xs-10">\n' +
                '<input type="text" class="form-control" placeholder="not has value" id="notHasVal' + notHasValFieldCount + '">\n' +
                '</div><div class="col-xs-2"><a href="#" class="not-has-val-remove">×</a></div>' +
                '</div>');
        });

        $("body").on("click", ".has-val-remove", function (e) { //user click on remove text
            $(this).parent('div').parent('div').remove(); //remove text box
            hasValFieldCount--;
        });

        $("body").on("click", ".not-has-val-remove", function (e) { //user click on remove text
            $(this).parent('div').parent('div').remove(); //remove text box
            notHasValFieldCount--;
        });

        $(submitButton).on('click', (e) => {
            e.preventDefault();
            spinner.spin('show');
            let table = $('#table').val();
            if (!table) {
                console.log("fill necessary fields");
                return;
            }
            let hasVals = [];
            let notHasVals = [];
            let hasValCount = 1;
            while (hasValCount <= hasValFieldCount) {
                let ele = $("#hasVal" + hasValCount);
                let value = ele.val();
                if (!value) {
                    console.log("fill necessary fields");
                    return;
                }
                hasValCount++;
                hasVals.push(value);
            }
            let notHasValCount = 1;
            while (notHasValCount <= notHasValFieldCount) {
                let ele = $("#notHasVal" + notHasValCount);
                let value = ele.val();
                if (!value) {
                    console.log("fill necessary fields");
                    return;
                }
                notHasValCount++;
                notHasVals.push(value);
            }


            let options = {
                url: requestUrl,
                data: {
                    table: table,
                    hasVal: hasVals.join(","),
                    notHasVal: notHasVals.join(",")
                },
                method: 'GET',
                success: (result) => {
                    $('#datatable-buttons').DataTable({
                        "ordering": false,
                        "data": result.data,
                        "columns": [
                            {"data": "val"},
                            {"data": "count"},
                        ]
                    });
                    spinner.spin('hide');
                },
                error: (err) => {
                    spinner.spin('hide');
                    console.log(err);
                }
            };
            $.ajax(options);
        })
    })
</script>
</body>
</html>